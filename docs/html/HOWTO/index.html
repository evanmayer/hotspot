
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Howto - hotspot</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-is-hotspot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="hotspot" class="md-header__button md-logo" aria-label="hotspot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hotspot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Howto
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/evanmayer/hotspot/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hotspot
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="hotspot" class="md-nav__button md-logo" aria-label="hotspot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    hotspot
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/evanmayer/hotspot/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hotspot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Howto
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Howto
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hotspot" class="md-nav__link">
    What is hotspot?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-this-document" class="md-nav__link">
    What is this document?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-timepi-the-raspberry-pi-control-computer" class="md-nav__link">
    Using timepi, the Raspberry Pi control computer
  </a>
  
    <nav class="md-nav" aria-label="Using timepi, the Raspberry Pi control computer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-you-talk-to-the-raspberry-pi" class="md-nav__link">
    Can you talk to the Raspberry Pi?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-the-environment-raspberry-pi" class="md-nav__link">
    Setting Up the Environment (Raspberry Pi)
  </a>
  
    <nav class="md-nav" aria-label="Setting Up the Environment (Raspberry Pi)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-the-environment-set-up" class="md-nav__link">
    Is the environment set up?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anaconda" class="md-nav__link">
    Anaconda
  </a>
  
    <nav class="md-nav" aria-label="Anaconda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-anaconda-set-up" class="md-nav__link">
    Is Anaconda set up?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-the-labjack-library-installed" class="md-nav__link">
    Is the LabJack library installed?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keeping-things-up-to-date" class="md-nav__link">
    Keeping things up to date
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-testing-with-pytest" class="md-nav__link">
    Software Testing with pytest
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-hardware" class="md-nav__link">
    Setting Up the Hardware
  </a>
  
    <nav class="md-nav" aria-label="Setting Up the Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-raspberry-pi-hardware" class="md-nav__link">
    Enable Raspberry Pi Hardware
  </a>
  
    <nav class="md-nav" aria-label="Enable Raspberry Pi Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-raspberry-pi-talk-to-the-motor-drivers" class="md-nav__link">
    Can the Raspberry Pi talk to the motor drivers?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power" class="md-nav__link">
    Power
  </a>
  
    <nav class="md-nav" aria-label="Power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are-the-power-supply-settings-correct" class="md-nav__link">
    Are the power supply settings correct?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motors" class="md-nav__link">
    Motors
  </a>
  
    <nav class="md-nav" aria-label="Motors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#do-the-motor-driver-boards-have-power" class="md-nav__link">
    Do the motor driver boards have power?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labjack" class="md-nav__link">
    LabJack
  </a>
  
    <nav class="md-nav" aria-label="LabJack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#do-the-hawkeyes-have-power-via-the-labjack" class="md-nav__link">
    Do the Hawkeyes have power via the LabJack?
  </a>
  
    <nav class="md-nav" aria-label="Do the Hawkeyes have power via the LabJack?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-mce-clk-sync" class="md-nav__link">
    Optional: MCE CLK Sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-outputs" class="md-nav__link">
    Motion Outputs
  </a>
  
    <nav class="md-nav" aria-label="Motion Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motors_1" class="md-nav__link">
    Motors
  </a>
  
    <nav class="md-nav" aria-label="Motors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-motor-drivers-command-the-motors" class="md-nav__link">
    Can the motor drivers command the motors?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spools" class="md-nav__link">
    Spools
  </a>
  
    <nav class="md-nav" aria-label="Spools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-motors-make-the-lines-longer-and-shorter" class="md-nav__link">
    Can the motors make the lines longer and shorter?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft" class="md-nav__link">
    Raft
  </a>
  
    <nav class="md-nav" aria-label="Raft">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#will-moving-the-cables-move-the-hawkeyes" class="md-nav__link">
    Will moving the cables move the Hawkeyes?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cable-maintenance" class="md-nav__link">
    Cable Maintenance
  </a>
  
    <nav class="md-nav" aria-label="Cable Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-if-a-cable-breaks" class="md-nav__link">
    What if a cable breaks?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame" class="md-nav__link">
    Frame
  </a>
  
    <nav class="md-nav" aria-label="Frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-the-frame-fully-assembled" class="md-nav__link">
    Is the frame fully assembled?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coordinate-system" class="md-nav__link">
    Coordinate System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    Input Files
  </a>
  
    <nav class="md-nav" aria-label="Input Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ok-but-is-there-an-easy-way-to-make-a-new-one" class="md-nav__link">
    Ok, but is there an easy way to make a new one?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geometry" class="md-nav__link">
    Geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile" class="md-nav__link">
    Profile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output Files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-installation-and-operation" class="md-nav__link">
    Physical Installation and Operation
  </a>
  
    <nav class="md-nav" aria-label="Physical Installation and Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physical-installation" class="md-nav__link">
    Physical Installation
  </a>
  
    <nav class="md-nav" aria-label="Physical Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-tips" class="md-nav__link">
    General tips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k1" class="md-nav__link">
    K1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k2" class="md-nav__link">
    K2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k3" class="md-nav__link">
    K3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f1" class="md-nav__link">
    F1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p2" class="md-nav__link">
    P2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operation" class="md-nav__link">
    Operation
  </a>
  
    <nav class="md-nav" aria-label="Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-note-on-homing" class="md-nav__link">
    A Note on Homing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-mapping-checks" class="md-nav__link">
    Pre-mapping checks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping" class="md-nav__link">
    Mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-documentation" class="md-nav__link">
    Other Documentation
  </a>
  
    <nav class="md-nav" aria-label="Other Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-call-graph" class="md-nav__link">
    Example Call Graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-flow-charts" class="md-nav__link">
    Module Flow Charts
  </a>
  
    <nav class="md-nav" aria-label="Module Flow Charts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executive" class="md-nav__link">
    Executive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-html" class="md-nav__link">
    Reference HTML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pycallgraph" class="md-nav__link">
    pycallgraph
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Hotspot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hotspot" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Hotspot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/algorithm/" class="md-nav__link">
        Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/executive/" class="md-nav__link">
        Executive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/hardware/" class="md-nav__link">
        Hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/hw_context/" class="md-nav__link">
        Hw Context
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/hotspot/telemetry/" class="md-nav__link">
        Telemetry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hotspot" class="md-nav__link">
    What is hotspot?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-this-document" class="md-nav__link">
    What is this document?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-timepi-the-raspberry-pi-control-computer" class="md-nav__link">
    Using timepi, the Raspberry Pi control computer
  </a>
  
    <nav class="md-nav" aria-label="Using timepi, the Raspberry Pi control computer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-you-talk-to-the-raspberry-pi" class="md-nav__link">
    Can you talk to the Raspberry Pi?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-the-environment-raspberry-pi" class="md-nav__link">
    Setting Up the Environment (Raspberry Pi)
  </a>
  
    <nav class="md-nav" aria-label="Setting Up the Environment (Raspberry Pi)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-the-environment-set-up" class="md-nav__link">
    Is the environment set up?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anaconda" class="md-nav__link">
    Anaconda
  </a>
  
    <nav class="md-nav" aria-label="Anaconda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-anaconda-set-up" class="md-nav__link">
    Is Anaconda set up?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-the-labjack-library-installed" class="md-nav__link">
    Is the LabJack library installed?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keeping-things-up-to-date" class="md-nav__link">
    Keeping things up to date
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-testing-with-pytest" class="md-nav__link">
    Software Testing with pytest
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-hardware" class="md-nav__link">
    Setting Up the Hardware
  </a>
  
    <nav class="md-nav" aria-label="Setting Up the Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-raspberry-pi-hardware" class="md-nav__link">
    Enable Raspberry Pi Hardware
  </a>
  
    <nav class="md-nav" aria-label="Enable Raspberry Pi Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-raspberry-pi-talk-to-the-motor-drivers" class="md-nav__link">
    Can the Raspberry Pi talk to the motor drivers?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power" class="md-nav__link">
    Power
  </a>
  
    <nav class="md-nav" aria-label="Power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are-the-power-supply-settings-correct" class="md-nav__link">
    Are the power supply settings correct?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motors" class="md-nav__link">
    Motors
  </a>
  
    <nav class="md-nav" aria-label="Motors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#do-the-motor-driver-boards-have-power" class="md-nav__link">
    Do the motor driver boards have power?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labjack" class="md-nav__link">
    LabJack
  </a>
  
    <nav class="md-nav" aria-label="LabJack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#do-the-hawkeyes-have-power-via-the-labjack" class="md-nav__link">
    Do the Hawkeyes have power via the LabJack?
  </a>
  
    <nav class="md-nav" aria-label="Do the Hawkeyes have power via the LabJack?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-mce-clk-sync" class="md-nav__link">
    Optional: MCE CLK Sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-outputs" class="md-nav__link">
    Motion Outputs
  </a>
  
    <nav class="md-nav" aria-label="Motion Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motors_1" class="md-nav__link">
    Motors
  </a>
  
    <nav class="md-nav" aria-label="Motors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-motor-drivers-command-the-motors" class="md-nav__link">
    Can the motor drivers command the motors?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spools" class="md-nav__link">
    Spools
  </a>
  
    <nav class="md-nav" aria-label="Spools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-the-motors-make-the-lines-longer-and-shorter" class="md-nav__link">
    Can the motors make the lines longer and shorter?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft" class="md-nav__link">
    Raft
  </a>
  
    <nav class="md-nav" aria-label="Raft">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#will-moving-the-cables-move-the-hawkeyes" class="md-nav__link">
    Will moving the cables move the Hawkeyes?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cable-maintenance" class="md-nav__link">
    Cable Maintenance
  </a>
  
    <nav class="md-nav" aria-label="Cable Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-if-a-cable-breaks" class="md-nav__link">
    What if a cable breaks?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame" class="md-nav__link">
    Frame
  </a>
  
    <nav class="md-nav" aria-label="Frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#is-the-frame-fully-assembled" class="md-nav__link">
    Is the frame fully assembled?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coordinate-system" class="md-nav__link">
    Coordinate System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    Input Files
  </a>
  
    <nav class="md-nav" aria-label="Input Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ok-but-is-there-an-easy-way-to-make-a-new-one" class="md-nav__link">
    Ok, but is there an easy way to make a new one?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geometry" class="md-nav__link">
    Geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile" class="md-nav__link">
    Profile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output Files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-installation-and-operation" class="md-nav__link">
    Physical Installation and Operation
  </a>
  
    <nav class="md-nav" aria-label="Physical Installation and Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physical-installation" class="md-nav__link">
    Physical Installation
  </a>
  
    <nav class="md-nav" aria-label="Physical Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-tips" class="md-nav__link">
    General tips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k1" class="md-nav__link">
    K1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k2" class="md-nav__link">
    K2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k3" class="md-nav__link">
    K3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f1" class="md-nav__link">
    F1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p2" class="md-nav__link">
    P2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operation" class="md-nav__link">
    Operation
  </a>
  
    <nav class="md-nav" aria-label="Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-note-on-homing" class="md-nav__link">
    A Note on Homing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-mapping-checks" class="md-nav__link">
    Pre-mapping checks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping" class="md-nav__link">
    Mapping
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-documentation" class="md-nav__link">
    Other Documentation
  </a>
  
    <nav class="md-nav" aria-label="Other Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-call-graph" class="md-nav__link">
    Example Call Graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-flow-charts" class="md-nav__link">
    Module Flow Charts
  </a>
  
    <nav class="md-nav" aria-label="Module Flow Charts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executive" class="md-nav__link">
    Executive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-html" class="md-nav__link">
    Reference HTML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pycallgraph" class="md-nav__link">
    pycallgraph
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/evanmayer/hotspot/edit/main/HOWTO.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <p>This doc contains instructions for various tasks related to setting up and running the <code>hotspot</code> mirror mapper.</p>
<h4 id="what-is-hotspot">What is <code>hotspot</code>?</h4>
<p><img alt="hotspot packed for Kitt Peak" src="../docs/img/allup.jpeg" /></p>
<p><code>hotspot</code> is a cable-driven parallel robot (CDPR), with four stepper motors that move a central raft of hot IR sources, mounted on an adjustable frame. It clamps to various relay mirrors that couple radiation from the sky to the TIME spectrometer inside the receiver cabin on the APA 12M telescope on Kitt Peak, allowing an electronically controlled, hot, IR-emitting source to be swept across the mirror to observe the detectors' spatial response. </p>
<h4 id="what-is-this-document">What is this document?</h4>
<p>This document is a comprehensive how-to on setting up, maintaining, and running the mirror mapper. It contains all the information that would be needed to replace and reconfigure major components of the system, however unlikely that may be.</p>
<p>It is organized in order of information flow: from the operator (you!) logging into the control computer, to setting up the software environment, connecting the power and signal cables, assembling the mapper frame, creating input files, mounting it on various mirrors, and operating the mapper. </p>
<h1 id="using-timepi-the-raspberry-pi-control-computer">Using <code>timepi</code>, the Raspberry Pi control computer</h1>
<p>The mapper is controlled by logging into the Raspberry Pi and running the <code>main.py</code> application. This repo should already be checked out on it, and you do not need to check out this repo onto a personal computer unless you wish to <a href="#ok-but-is-there-an-easy-way-to-make-a-new-one">generate new input files</a>.</p>
<h4 id="can-you-talk-to-the-raspberry-pi">Can you talk to the Raspberry Pi?</h4>
<p>You can log in to the Raspberry Pi via <code>ssh</code>. In order for your computer to "see" it, though, they must be on the same network. This can be accomplished a few ways (or order of ease of use):</p>
<ol>
<li>By connecting both computers to a router or network switch that can assign each connected device an IP address automatically. Wired is easier than <a href="https://www.raspberrypi.com/documentation/computers/configuration.html#setting-up-a-headless-raspberry-pi">wireless</a>.</li>
<li>By connecting directly to the pi via an Ethernet patch cable and setting up a <a href="https://en.wikipedia.org/wiki/Link-local_address">link-local</a> connection</li>
<li>By connecting directly to the pi via an Ethernet patch cable and assigning static IP addresses to each host.</li>
</ol>
<p>The first option is the easiest, but depends on having access to an exisiting network, so limits your connectivity options. If you have access to a Linux machine, the second option is about as easy.</p>
<p>The hostname and password are printed on the bottom of the white plastic case. Once you think the connection is sorted out, ping the pi to check:</p>
<div class="codehilite"><pre><span></span><code> ping timepi.local
</code></pre></div>

<p>The ssh command goes like this:</p>
<div class="codehilite"><pre><span></span><code> ssh -X pi@timepi.local
</code></pre></div>

<p><code>-X</code> allows X-forwarding, in case a graphical application (like plotting) is invoked. You will be prompted for a password, which you can find printed on the bottom of the white plastic Raspberry Pi case.</p>
<h2 id="setting-up-the-environment-raspberry-pi">Setting Up the Environment (Raspberry Pi)</h2>
<h4 id="is-the-environment-set-up">Is the environment set up?</h4>
<p>First, check that the environment setup has not been done before. If </p>
<div class="codehilite"><pre><span></span><code>conda activate hotspot
</code></pre></div>

<p>succeeds, skip <a href="#setting-up-the-environment-raspberry-pi">these steps</a>.</p>
<h3 id="anaconda">Anaconda</h3>
<h4 id="is-anaconda-set-up">Is Anaconda set up?</h4>
<p>If the Python environment/package manager <a href="https://www.anaconda.com/">Anaconda</a> does not exist on the Raspberry Pi you're running this on, I recommend installing Miniconda like this:</p>
<div class="codehilite"><pre><span></span><code>curl <span class="s2">&quot;https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-armv7l.sh&quot;</span> -o <span class="s2">&quot;Miniconda.sh&quot;</span>
chmod +x Miniconda.sh
./Miniconda.sh
</code></pre></div>

<p>Once that is done, we are ready to set up the <code>hotspot</code> environment. <code>conda</code> environments keep a project's dependencies from polluting your computer's environment and make sure they all play nicely together. <code>conda</code> allows specifying the dependencies needed in a file with a <code>.yml</code> extension. This is done for you. Create the <code>hotspot</code> conda env with</p>
<div class="codehilite"><pre><span></span><code>conda env create -f hotspot.yml
</code></pre></div>

<p>It should install things like <code>numpy</code> and <code>matplotlib</code>, as well as libraries for the hardware, such as Adafruit's <code>adafruit-circuitpython-motorkit</code> library for driving the steppers, and the <code>labjack-ljm</code> library for controlling the Hawkeye IR sources via the LabJack. There are also packages for documentation.</p>
<h4 id="is-the-labjack-library-installed">Is the LabJack library installed?</h4>
<blockquote>
<p><strong>NOTE:</strong> Driving Hawkeye sources with LabJack Python modules requires both the system libraries and the Python interface to be installed.</p>
</blockquote>
<p><a href="https://labjack.com/support/software/installers/ljm">Download and install</a> the LJM libraries from LabJack.</p>
<p>Once that is done, activate the env with </p>
<div class="codehilite"><pre><span></span><code>conda activate hotspot
</code></pre></div>

<h3 id="keeping-things-up-to-date">Keeping things up to date</h3>
<p>If you need to install something new later on, remember to update <code>hotspot.yml</code> by doing </p>
<div class="codehilite"><pre><span></span><code>conda env <span class="nb">export</span> --from-history <span class="p">|</span> tee hotspot.yml
</code></pre></div>

<p>If your <code>hotspot.yml</code> has been updated, and you need to update your env with the new <code>hotspot.yml</code>, do</p>
<div class="codehilite"><pre><span></span><code>conda env update --file hotspot.yml --prune
</code></pre></div>

<h1 id="software-testing-with-pytest">Software Testing with <code>pytest</code></h1>
<p>In order to verify that basic low-level functionality is unbroken, run <code>pytest</code> from the toplevel directory of the repo.</p>
<h1 id="setting-up-the-hardware">Setting Up the Hardware</h1>
<h2 id="enable-raspberry-pi-hardware">Enable Raspberry Pi Hardware</h2>
<h4 id="can-the-raspberry-pi-talk-to-the-motor-drivers">Can the Raspberry Pi talk to the motor drivers?</h4>
<p>The Raspberry Pi should have at least two <a href="https://learn.adafruit.com/adafruit-dc-and-stepper-motor-hat-for-raspberry-pi">motor driver hat boards</a>. These are blue PCBs with onboard chips that talk to the Raspberry Pi on an I2C bus via the 2x20 header pins. They issue commands to the motor driver chips, which handle the delivery and timing of greater voltage and current than the Raspberry Pi is capable of on its own.</p>
<p>If you are using a factory fresh Raspberry Pi, follow the steps for <a href="https://learn.adafruit.com/adafruit-dc-and-stepper-motor-hat-for-raspberry-pi/installing-software#enable-i2c-1106864-2">Enabling I2C communication</a> from Adafruit. </p>
<blockquote>
<p><strong>NOTE:</strong> A backup pdf of instructions for this is saved in the <code>pdf</code> dir.</p>
</blockquote>
<h2 id="power">Power</h2>
<h4 id="are-the-power-supply-settings-correct">Are the power supply settings correct?</h4>
<p>To power both the motors and Hawkeyes simultaneously, use a <strong>GW Instek GPS-4303</strong> power supply or equivalent; channels must supply:</p>
<ul>
<li>12V constant voltage, 4A peak instantaneous current</li>
<li>6.7V constant voltage, 2A peak instantaneous current</li>
<li>5V constant voltage, 1A peak instantaneous current (optional, for chopped signal to TIME MCE CLK card)</li>
</ul>
<p>Set the GW Instek GPS-4303 CH1, CH2, and optionally CH3 supply as shown:</p>
<p><img alt="PSU Settings" src="../docs/img/psu_settings.jpeg" /></p>
<p>Ensure the current limit knobs for each channel are sufficient to keep the power supply in constant voltage mode, even when the motors and Hawkeyes are drawing current. The C.V. indicator light should stay green.</p>
<h3 id="motors">Motors</h3>
<h4 id="do-the-motor-driver-boards-have-power">Do the motor driver boards have power?</h4>
<p>The Raspberry Pi cannot provide the requisite voltage or current to the motors on its own, so external power must be supplied. 
The motor controllers on each hat are designed to run with 5-12V, with a maximum instantaneous current of ~1.2A per channel.</p>
<p>For stacking multiple hats, jumpers are attached to the screw terminals to route +/- voltage to the additional hats. </p>
<p>A lab power supply with 12V output is attached to the +/- screw terminal block on the motor driver hat.</p>
<p><img alt="12 V to driver boards" src="../docs/img/motor_power.jpeg" /></p>
<p>As you can see, it's easiest to use leads with grabber probes to grab onto the +/- jumpers. </p>
<h3 id="labjack">LabJack</h3>
<h4 id="do-the-hawkeyes-have-power-via-the-labjack">Do the Hawkeyes have power via the LabJack?</h4>
<p>The LabJack T7 with PS12DC power switching board also needs its own power supply.</p>
<p>A tunable lab power supply is attached to one of the screw terminals labeled "VS#," for "voltage source #," where # is one of the channels, 1-6. </p>
<p>The Hawkeye IR-50 source temperature depends on the voltage applied, and the current draw depends on the voltage (see datasheet in <code>pdf</code> dir). The design target temperature is 750 C, requiring a voltage of 6.7V and a current of ~134mA per source, for a total current draw of ~1.74A when all sources are turned on. In practice, Hawkeye sources have not drawn quite this much current.</p>
<p>Connect the power supply and Hawkeye source wires to the LabJack as shown:</p>
<p><img alt="LabJack Wiring" src="../docs/img/labjack_wiring.jpeg" /></p>
<p>Finally, ensure the LabJack T7 is plugged into the Raspberry Pi's USB port.</p>
<h5 id="optional-mce-clk-sync">Optional: MCE CLK Sync</h5>
<p>It may be desirable to supply the same chopped signal the Hawkeyes see, but at 5V, to the MCE CLK card via a BNC cable. If this is desired, use the power supply CH3 set to 5V, and attach to +5V and GND to the terminal labeled S4.</p>
<h2 id="motion-outputs">Motion Outputs</h2>
<h3 id="motors_1">Motors</h3>
<h4 id="can-the-motor-drivers-command-the-motors">Can the motor drivers command the motors?</h4>
<p>If they are not already connected, motors should be connected to the screw terminals of the pi's stepper hat like this:</p>
<p><img alt="Stepper Wiring Example" src="../docs/img/stepper_wiring.jpg" /></p>
<p>Getting the order right ensures the stepper's coils are energized in the correct sequence to get it to rotate.</p>
<p>The stepper motors themselves have NEMA-17 spec hole patterns, which mate to the 3D printed motor mount brackets which we will attach to the beam mapper frame. Each stepper motor should be attached to its motor mount using M3 x 0.5 x 10 mm screws. Use lubricant, because metal on plastic will be squeaky.</p>
<p>At this point, it is important to consider the mapping of motor driver terminal -&gt; stepper motor -&gt; motor mount -&gt; corner of beam mapper frame. The <code>Executive.__init__()</code> function specifies this mapping, so the motor installation location and stepper instance in <code>__init__()</code> should match, to ensure the correct motor commands are sent to the correct stepper. Steppers and wire harnesses are labeled to assist with this.</p>
<p>In general, the driver board closest to the Pi (0n bottom) will be <code>kit0</code> (although this can be double-checked by looking at the address - <code>0x60</code> is the default I2C address for the hat, which can be changed by bridging the HAT pads A0-A4, so the board addressed by <code>0x60</code> will have no pads bridged). The terminal blocks M1-M2 are used for <code>stepper1</code> on each HAT, and M3-M4 are used for <code>stepper2</code>.</p>
<p>It doesn't really matter which terminal maps to which corner, but it really does matter that the code and physical arrangement agree.</p>
<h3 id="spools">Spools</h3>
<h4 id="can-the-motors-make-the-lines-longer-and-shorter">Can the motors make the lines longer and shorter?</h4>
<p>If they are not already attached, the spools should be fixed to the 5 mm stepper motor shaft via one M3 setscrew. </p>
<p>The fishing line is affixed to the each spool by wrapping it around the setscrew and screwing it in to the threaded recess on the spool circumference. Do not overtighten, as the threads are plastic.</p>
<p><img alt="View of spool and M3 setscrew" src="../docs/img/spool_side_view.jpg" /></p>
<blockquote>
<p><strong>NOTE:</strong> Positive motor rotation is defined by convention to spin the shaft clockwise when viewed from the rear of the motor. Cables should be oriented relative to the spool such that a positive motor rotation produces a positive cable length change (i.e., cable is played out from the spool), and a negative motor rotation winds cable onto the spool.</p>
</blockquote>
<p>After attaching the cables to the spools, the other end should be threaded through the ~.9mm hole in the motor mount bracket.</p>
<blockquote>
<p><strong>NOTE:</strong> All cables should be long enough to permit the raft to visit each corner of the frame, even when the frame is as far apart as it can be (~25.5").</p>
</blockquote>
<p>Finally, excess cable should be wound onto the spool, under tension, to avoid trapping excess cable underneath as the cable is wound on. This process should be done by hand.</p>
<h3 id="raft">Raft</h3>
<h4 id="will-moving-the-cables-move-the-hawkeyes">Will moving the cables move the Hawkeyes?</h4>
<p>The end effector of this robot is a rectangular raft carrying several Hawkeye Technologies <a href="http://www.hawkeyetechnologies.com/source-selection/pulsable/">IR-50</a> emitters. The robot drives the centroid of the effector to a specified position, and the control algorithm performs a specific sequence of flashes using a number of the emitters to enhance the detectability of the signal in the TIME receiver output data.</p>
<p>If the raft is not already attached to the cables, the raft cap with the Hawkeye emitters must be removed to access the screws to fix the affix the lines.</p>
<p>Simply pass them through the raft's eyelets, wrapping the ends of the fishing line around the screws in each corner of the raft, and screwing them down. </p>
<h3 id="cable-maintenance">Cable Maintenance</h3>
<h4 id="what-if-a-cable-breaks">What if a cable breaks?</h4>
<p>The lid of the raft is secured by clips and a dab of cyanoacrylate glue in each corner. If the cables need to be changed (e.g., they are worn), an exacto blade can be used to break the CA glue in the corners and remove the lid. The original cable is Spiderwire EZ Braid braided dyneema fishing line (50 lb pull strength), chosen for its stretch resistance. A replacement can be found at any tackle store or Wal-Mart, but a spool of extra cable should already be stored with the beam mapper.</p>
<p><img alt="mid-cable-replacement" src="../docs/img/cable_replacement.jpeg" /></p>
<h2 id="frame">Frame</h2>
<h4 id="is-the-frame-fully-assembled">Is the frame fully assembled?</h4>
<p>The 3D printed stepper motor mounts are attached to the beam mapper frame by 5/16-18 x 2" or 2.25" bolts with nyloc "jam" nuts.</p>
<p>Two aluminum registration tabs are screwed into the end of each frame piece opposite the black plastic end caps, using a 5/16-18 x 1/4" screw. They are long enough to reach an edge of the mirror regardless of if the mirror's corners have been machined off. </p>
<blockquote>
<p><strong>NOTE:</strong> These tabs register the frame to a third edge of the mirror, so <strong>it is important that they not be bent</strong>.</p>
</blockquote>
<p>Long 5/16-18 steel threaded rods connect the two halves of the frame. On one end of the threaded rods, a nyloc "jam" nut on the outside of the perforated aluminum extrusion provides clamping force. On the other end of the threaded rod, a slide-adjust nut with a thumb button allows easily changing the distance between clamping surfaces, and applies clamping force to the outside of the opposite aluminum extrusion. </p>
<h1 id="coordinate-system">Coordinate System</h1>
<p>In order for the raft to be moved to a meaningful position in mirror-space, coordinates must be referenced to sensible locations where the mirror edges and robot frame register to one another.</p>
<ul>
<li><strong>x-axis</strong>: plane of contact between the "south" frame and an edge of the mirror</li>
<li><strong>y-axis</strong>: plane of contact between the "west" side aluminum registration tab and a perpendicular mirror edge.</li>
</ul>
<p>The coordinate system of the robot therefore has its origin at the SW corner, where the aluminum alignment tab on the fixed frame meets the aluminum extrusion face.</p>
<h1 id="input-files">Input Files</h1>
<p>There are two types of input files: <code>geometry</code> and <code>profile</code>.
Read on to learn what they are for and what is inside each.</p>
<h4 id="ok-but-is-there-an-easy-way-to-make-a-new-one">Ok, but is there an easy way to make a new one?</h4>
<p><code>.ipynb</code> files are provided in the <code>data/input/*</code> directories to assist with making these input files. Most likely, you will only need <code>data/input/create_profile.ipynb</code>.</p>
<p>The Raspberry Pi does not have Jupyter installed, so you would need a local checkout of <code>hotspot</code> or a copy of these notebooks to run on your own machine. Then simply copy the new files to the Raspberry Pi's <code>/data/input/*</code> directory with <code>scp</code>.</p>
<h3 id="geometry">Geometry</h3>
<p>Geometry files are one-line .csv files in <code>data/input/geometry</code>. </p>
<p><code>create_geometry.ipynb</code> is provided to script the creation of geometry files.</p>
<p>Each one defines the physical setup of the robot when it is in a certain configuration, for instance, when it is installed on a mirror of a certain dimension. Each column entry describes an aspect of the physical setup of the system. A simplistic example:</p>
<table>
<thead>
<tr>
<th align="center">sw_0</th>
<th align="center">sw_1</th>
<th align="center">nw_0</th>
<th align="center">nw_1</th>
<th align="center">se_0</th>
<th align="center">se_1</th>
<th align="center">ne_0</th>
<th align="center">ne_1</th>
<th align="center">w</th>
<th align="center">h</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">.1</td>
<td align="center">.1</td>
</tr>
</tbody>
</table>
<p><img alt="geometry" src="../docs/img/geometry.png" /></p>
<p>Each corner point is the location of an <strong>eyelet</strong> through which the cable passes, expressed relative to the SW origin, described above. The width and height of the raft are defined by the separations between eyelets on the raft through which the cable passes.</p>
<blockquote>
<p><strong>NOTE:</strong> Since the dimensions of the motor mounts have been measured relative to each edge, the y-positions of the corner eyelets can be calculated as a function of the separation between the aluminum extrusions that make up the support structure and clamping surfaces.</p>
<p>The eyelets of the motor mounts measured 6.19 +/- 0.5 mm from the frame to the face of the motor mount bracket on the interior of the mapping region, and 7.96 +/- 0.02 mm from the face of the motor mount to the eyelet, for a total eyelet offset from the contact patch of 0.014 +/- 0.001 m. This value will be used to calculate eyelet y-positions as a function of frame separation.</p>
<p>The eyelet positions should not ever change in the x-direction, unless the motor mounts are removed from the aluminum frames.</p>
</blockquote>
<h3 id="profile">Profile</h3>
<p>Profile files are multi-line .csv files in <code>data/input/profiles</code>. Each one defines a new position to which the robot should move, in the coordinate system defined above.</p>
<p><code>geometry/create_profile.ipynb</code> is provided to script the creation of profiles.</p>
<p><img alt="profile" src="../docs/img/profile.png" /></p>
<p>Upon reaching each location in the profile, the robot is programmed to flash Hawkeye sources on and off (default: 10 "on" states, 50% duty cycle, 5 Hz). Which group of sources is enabled is configurable with the <code>flasher_cmds</code> column in the profile .csv. Each 0 or 1, space-separated, in the first column, corresponds to one of twelve addressable solid state switchable voltage sources on the LabJack PS12DC Power Switching Board. The index-to-address mapping is defined in the dictionary at the top of <code>hardware.py</code>. Since there are 3 groups of Hawkeye sources, there are more addressable relays than strictly necessary.</p>
<p>For example, to move to a single coordinate and flash all addresses:</p>
<table>
<thead>
<tr>
<th align="center">flasher_cmds</th>
<th align="center">pos_cmd_0s</th>
<th align="center">pos_cmd_1s</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1 1 1 1 1 1 1 1 1 1 1 1</td>
<td align="center">.5</td>
<td align="center">.5</td>
</tr>
</tbody>
</table>
<p>to move to a single coordinate and flash only the center Hawkeye:</p>
<table>
<thead>
<tr>
<th align="center">flasher_cmds</th>
<th align="center">pos_cmd_0s</th>
<th align="center">pos_cmd_1s</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1 0 0 0 0 0 0 0 0 0 0 0</td>
<td align="center">.5</td>
<td align="center">.5</td>
</tr>
</tbody>
</table>
<p>to move to a single coordinate and flash the center and inner ring Hawkeyes:</p>
<table>
<thead>
<tr>
<th align="center">flasher_cmds</th>
<th align="center">pos_cmd_0s</th>
<th align="center">pos_cmd_1s</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1 1 0 0 0 0 0 0 0 0 0 0</td>
<td align="center">.5</td>
<td align="center">.5</td>
</tr>
</tbody>
</table>
<p>to move to a single coordinate and flash all Hawkeyes (center, inner ring, outer ring):</p>
<table>
<thead>
<tr>
<th align="center">flasher_cmds</th>
<th align="center">pos_cmd_0s</th>
<th align="center">pos_cmd_1s</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1 1 1 0 0 0 0 0 0 0 0 0</td>
<td align="center">.5</td>
<td align="center">.5</td>
</tr>
</tbody>
</table>
<p>Building up a sequence of moves allows a shape to be scanned.</p>
<h2 id="output-files">Output Files</h2>
<p>Output files store telemetry for each run in <code>data/output</code>. They are timestamped <code>.hdf5</code> files.</p>
<h1 id="physical-installation-and-operation">Physical Installation and Operation</h1>
<h2 id="physical-installation">Physical Installation</h2>
<h3 id="general-tips">General tips</h3>
<ul>
<li>
<p>Having two people helps.</p>
</li>
<li>
<p><em><span style="color:red"><strong>BE VERY CAREFUL</strong> about touching the buttons on the black slide-adjust nuts</span></em></p>
<ul>
<li>If you are adjusting the mapper spacing and you let them off of the threaded rod, they will disassemble themselves rapidly. You don't want to lose any parts.</li>
<li>If you are loosening or tightening the mapper down to anything, when the mapper is under tension, touching the button could release tension rapidly, potentially causing a fall, which you do not want.</li>
</ul>
</li>
<li>
<p>Bring a power strip to make moving the PSU and Raspberry Pi to various mirrors easier. Bring a long ethernet cable to plug the Raspberry Pi into the rack's network switch.</p>
</li>
<li>
<p>Don't bother trying to tape Eccosorb to anything. Just pinch it in between the mirror and threaded rod. This also helps keep the threaded rod from marring the mirror surface.</p>
</li>
<li>
<p>Keep as much stuff as possible out of the path of the beam.</p>
</li>
</ul>
<h3 id="k1">K1</h3>
<p>Underneath shutter, highest up. Put a step ladder inside the K-mirror frame to make the lift easier. Route Hawkeye cables around back of K1 and down.</p>
<p><code>python main.py ./data/input/geometry/K1.csv ./data/input/profiles/K1_&lt;profile&gt;.csv</code></p>
<p><img alt="K1" src="../docs/img/K1_orientation.jpeg" /></p>
<h3 id="k2">K2</h3>
<p>Should be easy. Remove the anti-head-smasher foam first.</p>
<p><code>python main.py ./data/input/geometry/K2.csv ./data/input/profiles/K2_&lt;profile&gt;.csv</code></p>
<p><img alt="K2" src="../docs/img/K2_orientation.jpeg" /></p>
<h3 id="k3">K3</h3>
<p>Pucker factor 11. Gravity is working against you, and you're right on top of F1, but snug things down good and tight when mounting the mapper and you will be fine. I used a crescent wrench on the black slide-adjust nuts for this one. Be careful not to release the slide-adjust nuts when using the wrench.</p>
<p><code>python main.py ./data/input/geometry/K3.csv ./data/input/profiles/K3_&lt;profile&gt;.csv</code></p>
<p><img alt="K3" src="../docs/img/K3_orientation.jpeg" /></p>
<h3 id="f1">F1</h3>
<p>Another easy one.</p>
<p><code>python main.py ./data/input/geometry/F1.csv ./data/input/profiles/F1_&lt;profile&gt;.csv</code></p>
<p><img alt="F1" src="../docs/img/F1_orientation.jpeg" /></p>
<h3 id="p2">P2</h3>
<p>Not currently reachable (clearance issues).</p>
<h2 id="operation">Operation</h2>
<p>When a surface geometry file has been created and the profile for the given shape to be mapped is generated, we are ready to run the program. There should already be geometry and profile files in the <code>data/input</code> directories.</p>
<h3 id="a-note-on-homing">A Note on Homing</h3>
<p>Homing a system with no stall sensing in the motor driver solution and no limit switches is possible, but crude. </p>
<p>To get around the fact that there is no feedback, the current homing solution is to release all but one axis, then issue enough retracting steps to the remaining motor to ensure the raft has reached the limit of its travel toward that axis (NW at the time of writing). This axis is then held while the other steppers issue enough retracting steps to ensure all cables are taut. The raft is then in a known position and orientation relative to the frame, so the mapper is homed.</p>
<p>You will hear and see vibration while this happens.</p>
<p><img alt="example homed position, lid off" src="../docs/img/home_pos.jpeg" /></p>
<p>It is a simple, hands-free homing solution, but there is plenty of room for improvement here. Sensors would not be hard to add, would speed up homing, and would reduce the wear on cables (and probably motors) due to the current solution.</p>
<h2 id="pre-mapping-checks">Pre-mapping checks</h2>
<ol>
<li>Make sure that 12V is being supplied to both motor driver boards in the stack, that the polarity is correct.</li>
<li>Make sure that 6.7V or less is being supplied to the LabJack switching board.</li>
<li>Make sure the power supply output is on.</li>
<li>Make sure that the cable is wound onto each spool and that no loops of excess cable are trapped underneath the cable wound onto the spools.</li>
<li>Check the excess cable played out in the raft's current position. Some excess is fine as long as it doesn't interfere with the raft's motion. If the cable is taut before homing, this is also fine, but the homing routine may need to be run a few times before the raft reaches the home position.</li>
<li>Ensure the Hawkeye source signal lines won't interfere with mapper operation.</li>
<li>Ensure the <code>hotspot</code> <code>conda</code> env is active: <code>conda activate hotspot</code>.</li>
</ol>
<h2 id="mapping">Mapping</h2>
<ol>
<li>Start the program with <code>python main.py ./data/input/geometry/&lt;geometry.csv&gt; ./data/input/profiles/&lt;profile.csv&gt;</code></li>
<li>Perform a homing calibration: <code>c</code>, <code>RETURN</code> key. </li>
<li>The NW motor will drive the raft to the NW corner while the NE, SW, SE axes go slack, and NW should begin skipping steps after reaching the limit. This (and some noise) is normal. The other axes then tension automatically.</li>
<li>Verify that the raft reached its home against the NW corner, and that the other axes achieved tension. If not, GOTO 2.</li>
<li>Perform a mapping sequence: <code>s</code>, <code>RETURN</code> key. </li>
<li>The raft will drive to each location and flash the Hawkeyes at each point in the sequence. Observe the mapper, ensuring the Hawkeye signal cable does not interfere with the mapper.<ol>
<li>You may request a mode change at any time. Mode changes are processed at the end of each move.</li>
<li>You may abort the program with <code>Ctrl+C</code>.</li>
</ol>
</li>
<li>Upon completing a sequence, it may be repeated by requesting the sequence mode again.</li>
</ol>
<h1 id="other-documentation">Other Documentation</h1>
<h2 id="example-call-graph">Example Call Graph</h2>
<p>Generated without motors or LabJack attached, so this does not include overhead of those libraries, but the control flow is the same.</p>
<p><img alt="callgraph" src="../docs/img/pycallgraph.png" /></p>
<h2 id="module-flow-charts">Module Flow Charts</h2>
<h3 id="executive">Executive</h3>
<p><img alt="executive" src="../docs/img/executive.drawio.png" /></p>
<h2 id="reference-html">Reference HTML</h2>
<p>The html documentation of the source code and Markdown materials is generated by <a href="https://timothycrosley.github.io/portray/">portray</a>.</p>
<p>To regenerate the documentation, execute:</p>
<div class="codehilite"><pre><span></span><code>portray as_html -m hotspot -o docs/html/ --overwrite
</code></pre></div>

<h2 id="pycallgraph"><code>pycallgraph</code></h2>
<p>To re-generate the call graph image, directory, run</p>
<div class="codehilite"><pre><span></span><code>pycallgraph -i <span class="s2">&quot;alg*&quot;</span> -i <span class="s2">&quot;const*&quot;</span> -i <span class="s2">&quot;exec*&quot;</span> -i <span class="s2">&quot;hardw*&quot;</span> -i <span class="s2">&quot;hot*&quot;</span> -i <span class="s2">&quot;hw*&quot;</span> -i <span class="s2">&quot;tele*&quot;</span> graphviz --output-file<span class="o">=</span>../doc/img/pycallgraph.png -- main.py ../data/input/geometry/frame.csv ../data/input/profiles/box_frame.csv
</code></pre></div>

<p>You must have <code>graphviz</code> installed using your operating system's package manager. For most accurate graph and timing information, do this with all peripheral hardware attached, so the call graphs include interfacing with the motor drivers and LabJack.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../reference/hotspot/algorithm/" title="Algorithm" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Algorithm
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>